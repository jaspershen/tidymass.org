---
title: "Build your own docker image based on tidymass"
weight: 4
categories: [installation]
author:
- name: Xiaotao Shen (https://www.shenxt.info/)
date: "Created on 2022-02-18 and updated on 2022-03-10"
output:
  html_document:
    number_sections: true
    df_print: paged
    toc: yes
  pdf_document:
    toc: no
vignette: >
  %\VignetteIndexEntry{build_docker}
  %\VignettePackage{tidymass}
  % \VignetteEngine{knitr::rmarkdown}
  % \usepackage[utf8]{inputenc}
  %\VignetteEncoding{UTF-8}
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>You can build your own docker image, which contains all your <code>code</code>, <code>data</code> and <code>analysis environment</code>, which is more efficient for reproducible analysis.</p>
<div id="create-dockerfile" class="section level1">
<h1>Create <code>dockerfile</code></h1>
<p>Create a <code>dockerfile</code> without extension. And then open and modify it.</p>
<pre><code>FROM jaspershen/tidymass:latest
MAINTAINER &quot;Xiaotao Shen&quot; shenxt1990@outlook.com

RUN apt-get update &amp;&amp; apt-get install -y curl

COPY demo_data/ /home/rstudio/demo_data/

RUN chmod 777 /home/rstudio/demo_data/

RUN R -e &#39;install.packages(&quot;remotes&quot;)&#39;

RUN R -e &quot;remotes::install_gitlab(&#39;jaspershen/tidymass&#39;)&quot;</code></pre>
<p>If you want to install packages (for example ggraph) which are necessary for you analysis, please add a new line:</p>
<pre><code>RUN R -e &#39;install.packages(&quot;ggraph&quot;)&#39;</code></pre>
<p>And you also need to copy your data to the image use the <code>COPY</code>.</p>
<div id="build-image" class="section level2">
<h2>Build image</h2>
<p>In the <code>terminal</code>, use below code to build the image.</p>
<pre><code>docker build -t image-name -f Dockerfile .</code></pre>
<p>Change the <code>image-name</code>.</p>
</div>
</div>
<div id="use-the-docker-tag-command-to-give-the-tidymass-image-a-new-name" class="section level1">
<h1>Use the <code>docker tag</code> command to give the <code>tidymass</code> image a new name</h1>
<p>We need to create a account on the docker hub (<a href="https://hub.docker.com/" class="uri">https://hub.docker.com/</a>) and then use the next code to link the local image to our account.</p>
<pre><code>docker tag image-name your-account/image-name:latest</code></pre>
</div>
<div id="push-image-to-docker-hub" class="section level1">
<h1>Push image to docker hub</h1>
<pre><code>docker push your-account/image-name:latest</code></pre>
<p>Then other people can download your image which contains your code, data and analysis environment, which make it is pretty easy to repeat your analysis and results.</p>
<p>How to pull docker image and run it can <a href="https://tidymass.github.io/tidymass/articles/docker.html">refer this document</a>.</p>
</div>
<div id="session-information" class="section level1">
<h1><strong>Session information</strong></h1>
<pre class="r"><code>sessionInfo()
#&gt; R version 4.1.2 (2021-11-01)
#&gt; Platform: x86_64-apple-darwin17.0 (64-bit)
#&gt; Running under: macOS Big Sur 10.16
#&gt; 
#&gt; Matrix products: default
#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib
#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib
#&gt; 
#&gt; locale:
#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
#&gt; 
#&gt; attached base packages:
#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     
#&gt; 
#&gt; other attached packages:
#&gt; [1] magrittr_2.0.2
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;  [1] bookdown_0.24   here_1.0.1      rprojroot_2.0.2 digest_0.6.29  
#&gt;  [5] R6_2.5.1        jsonlite_1.7.3  evaluate_0.15   blogdown_1.7   
#&gt;  [9] rlang_1.0.1     stringi_1.7.6   cli_3.2.0       rstudioapi_0.13
#&gt; [13] jquerylib_0.1.4 bslib_0.3.1     rmarkdown_2.11  tools_4.1.2    
#&gt; [17] stringr_1.4.0   xfun_0.29       yaml_2.3.4      fastmap_1.1.0  
#&gt; [21] compiler_4.1.2  htmltools_0.5.2 knitr_1.37      sass_0.4.0</code></pre>
</div>
